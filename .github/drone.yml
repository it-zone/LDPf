# (C) Serge Victor 2020-2024, GPLv3 License
# 
# recently build version of documents is available on permanent storage disk mounted on /LDP

kind: pipeline
type: docker
name: ðŸ—ƒ LDP Builder

workspace:
  path: /builder/src
   
steps:
- name: Martin's builder
  image: tldp/builder:latest
  volumes:
  - name: LDPPRs
    path: /builder/PRs
  commands:
  - ldptool --dump-cfg
  - rm -rf /builder/PRs/*
  - mkdir -p /builder/PRs/BUILD
  - mkdir -p /builder/PRs/MAIN
  - ldptool --loglevel info --builddir /builder/PRs/BUILD --configfile .github/builder-pr.ldptool.cfg --pubdir /builder/PRs/MAIN --list
  - ldptool --loglevel info --builddir /builder/PRs/BUILD --configfile .github/builder-pr.ldptool.cfg --pubdir /builder/PRs/MAIN --publish

volumes:
- name: LDPPRs
  host:
    path: /LDP/PRs

# the happy end.
